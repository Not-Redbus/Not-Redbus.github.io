<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANDREW | DIRECTORY</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { background-color: #000; color: #f59e0b; font-family: 'Roboto Mono', monospace; }
        
        /* UI Components */
        .mode-switch { cursor: pointer; user-select: none; transition: all 0.3s; }
        .mode-legacy { background: #450a0a; color: #fca5a5; border: 1px solid #991b1b; }
        .mode-prod { background: #064e3b; color: #6ee7b7; border: 1px solid #059669; }
        
        .terminal-box { background-color: #09090b; border: 1px solid #27272a; padding: 10px; border-radius: 4px; }
        .insight-box { background-color: #1e1b4b; border-left: 3px solid #6366f1; padding: 12px; } /* Blue Box for Insights */
        
        .spec-label { color: #52525b; font-size: 10px; text-transform: uppercase; letter-spacing: 1px; font-weight: bold; margin-bottom: 4px; display: block; }
        .spec-text { color: #a1a1aa; font-size: 11px; line-height: 1.5; }
        
        .http-btn { font-size: 10px; font-weight: bold; padding: 6px; border: 1px solid #333; transition: all 0.1s; }
        .http-btn:hover { transform: translateY(-1px); }
        .btn-get:hover { background: #0ea5e9; color: white; }
        .btn-post:hover { background: #22c55e; color: white; }
        .btn-put:hover { background: #eab308; color: white; }
        .btn-delete:hover { background: #ef4444; color: white; }

        textarea { width: 100%; background: transparent; border: none; outline: none; resize: none; font-family: inherit; font-size: 11px; }
        .status-badge { font-size: 10px; padding: 2px 6px; border-radius: 2px; background: #27272a; color: #a1a1aa; }
    </style>
</head>
<body class="min-h-screen p-4 sm:p-12 max-w-6xl mx-auto">

    <div class="mb-8 border-b border-zinc-800 pb-4 flex flex-col sm:flex-row justify-between items-start sm:items-end gap-4">
        <div>
            <a href="index.html" class="text-zinc-600 hover:text-white text-xs mb-2 block">&lt; .. (GO BACK)</a>
            <h1 class="text-lg sm:text-xl">C:\USERS\ANDREW\LAB_01\</h1>
        </div>
        
        <div onclick="toggleMode()" id="mode-btn" class="mode-switch mode-legacy px-4 py-2 text-xs font-bold rounded shadow-lg flex items-center gap-2">
            <span id="mode-icon">üî¥</span>
            <span>MODE: LEGACY (NO SPECS)</span>
        </div>
    </div>

    <div class="grid lg:grid-cols-2 gap-8">
        
        <div>
            <div class="flex justify-between items-end mb-2">
                <span class="spec-label text-orange-500">>> SERVER_DATABASE (STATE)</span>
                <span id="db-status" class="text-[10px] text-red-500 font-bold">UNPROTECTED</span>
            </div>
            
            <div class="terminal-box min-h-[120px] mb-4 flex flex-col justify-center relative overflow-hidden">
                <pre id="db-display" class="text-[10px] whitespace-pre-wrap transition-all duration-300"></pre>
                <div id="watermark" class="absolute top-2 right-2 text-[40px] font-black text-white/5 pointer-events-none">LEGACY</div>
            </div>

            <div class="grid grid-cols-4 gap-2 mb-4">
                <button onclick="execute('GET')" class="http-btn btn-get text-blue-400">GET</button>
                <button onclick="execute('POST')" class="http-btn btn-post text-green-400">POST</button>
                <button onclick="execute('PUT')" class="http-btn btn-put text-yellow-400">PUT</button>
                <button onclick="execute('DELETE')" class="http-btn btn-delete text-red-400">DEL</button>
            </div>

            <div class="flex justify-between items-end mb-1">
                <span class="spec-label">>> CLIENT_PAYLOAD</span>
                <span id="status-code" class="status-badge">READY</span>
            </div>
            <div class="terminal-box h-32 relative">
                <textarea id="client-input" class="text-orange-400 h-full" placeholder="// Input JSON..."></textarea>
                <div id="client-overlay" class="absolute inset-0 bg-black/95 text-blue-400 text-[10px] p-2 hidden whitespace-pre-wrap font-mono overflow-auto"></div>
            </div>
        </div>

        <div class="border-l border-zinc-800 pl-0 lg:pl-8 flex flex-col h-full justify-between" id="doc-panel">
            
            <div id="specs-content"></div>

            <div class="mt-8">
                <span class="spec-label text-indigo-400 mb-2 block">>> PM_TAKEAWAY (LEARNING OBJECTIVE)</span>
                <div class="insight-box rounded">
                    <p id="insight-text" class="text-[11px] text-indigo-100 leading-relaxed font-medium">
                        Loading insight...
                    </p>
                </div>
            </div>

        </div>

    </div>

    <script>
        let isProdMode = false; 
        let db = generateDB();

        const content = {
            legacy: {
                title: "‚ö†Ô∏è LEGACY API (NO REQUIREMENTS)",
                desc: "Behaving as raw code dictates. No safeguards.",
                put_rule: "<span class='text-red-400'>RISK:</span> Blind Replacement. If you PUT without an ID, the ID is deleted.",
                del_rule: "<span class='text-red-400'>RISK:</span> Hard Delete. Data is destroyed immediately.",
                status: "UNPROTECTED",
                insight: "WHAT TO WATCH: Try clicking DELETE. Notice the data is gone forever. This happens when PMs assume engineers will 'just know' to archive data. Without a written requirement for Soft Deletes, you get Hard Deletes."
            },
            prod: {
                title: "‚úÖ V2.0 API (WITH PM SPECS)",
                desc: "Enforcing Business Rules for Data Integrity.",
                put_rule: "<span class='text-green-400'>SAFE:</span> Schema Validation. Rejects payloads missing critical fields.",
                del_rule: "<span class='text-green-400'>SAFE:</span> Soft Delete. Marks as 'archived' (status: inactive).",
                status: "PROTECTED",
                insight: "WHAT TO WATCH: Try sending a bad PUT request. The system fights back (400 Bad Request). This friction is intentional. We are trading speed for safety, ensuring the Frontend cannot accidentally corrupt the Database."
            }
        };

        // INIT
        renderMode();
        renderDB();

        function toggleMode() {
            isProdMode = !isProdMode;
            db = generateDB(); 
            renderMode();
            renderDB();
            document.getElementById('client-input').value = `{\n  "content": "New Content"\n}`;
            document.getElementById('status-code').innerText = "SYSTEM RESET";
            document.getElementById('status-code').style.color = "#a1a1aa";
        }

        function renderMode() {
            const btn = document.getElementById('mode-btn');
            const watermark = document.getElementById('watermark');
            const dbStatus = document.getElementById('db-status');
            const specs = document.getElementById('specs-content');
            const insight = document.getElementById('insight-text');
            
            const data = isProdMode ? content.prod : content.legacy;

            if (isProdMode) {
                btn.className = "mode-switch mode-prod px-4 py-2 text-xs font-bold rounded shadow-lg flex items-center gap-2";
                btn.innerHTML = `<span>üü¢</span><span>MODE: V2.0 (WITH SPECS)</span>`;
                watermark.innerText = "SECURE";
                watermark.className = "absolute top-2 right-2 text-[40px] font-black text-green-900/20 pointer-events-none";
                dbStatus.className = "text-[10px] text-green-500 font-bold";
            } else {
                btn.className = "mode-switch mode-legacy px-4 py-2 text-xs font-bold rounded shadow-lg flex items-center gap-2";
                btn.innerHTML = `<span>üî¥</span><span>MODE: LEGACY (NO SPECS)</span>`;
                watermark.innerText = "LEGACY";
                watermark.className = "absolute top-2 right-2 text-[40px] font-black text-red-900/10 pointer-events-none";
                dbStatus.className = "text-[10px] text-red-500 font-bold";
            }

            dbStatus.innerText = data.status;
            insight.innerText = data.insight;

            specs.innerHTML = `
                <div class="mb-6">
                    <h3 class="text-sm font-bold text-white mb-2">${data.title}</h3>
                    <p class="spec-text italic mb-4">${data.desc}</p>
                </div>
                <div class="mb-4">
                    <span class="spec-label">01. PUT BEHAVIOR</span>
                    <div class="bg-zinc-900 p-2 rounded border border-zinc-800 text-[10px] text-zinc-300 leading-relaxed">${data.put_rule}</div>
                </div>
                <div class="mb-4">
                    <span class="spec-label">02. DELETE BEHAVIOR</span>
                    <div class="bg-zinc-900 p-2 rounded border border-zinc-800 text-[10px] text-zinc-300 leading-relaxed">${data.del_rule}</div>
                </div>
            `;
        }

        function execute(method) {
            const overlay = document.getElementById('client-overlay');
            const status = document.getElementById('status-code');
            const input = document.getElementById('client-input');
            
            overlay.classList.add('hidden');
            status.className = "status-badge";

            // GET
            if (method === 'GET') {
                if (!db) {
                    status.innerText = "404 NOT FOUND"; status.style.color = "#ef4444";
                    overlay.innerText = "// 404: Resource not found.";
                } else {
                    status.innerText = "200 OK"; status.style.color = "#22c55e";
                    if (isProdMode && db._archived) {
                        status.innerText = "404 NOT FOUND (SOFT DELETE)"; status.style.color = "#eab308";
                        overlay.innerText = "// Resource is archived. Client sees 404. Admin sees data.";
                    } else {
                        overlay.innerText = JSON.stringify(db, null, 2);
                    }
                }
                overlay.classList.remove('hidden');
            }

            // POST
            else if (method === 'POST') {
                const payload = parse(); if (!payload) return;
                if (db && isProdMode) {
                     status.innerText = "409 CONFLICT"; status.style.color = "#eab308";
                } else {
                    db = { ...payload, id: "REC-99", timestamp: new Date().toISOString() };
                    status.innerText = "201 CREATED"; status.style.color = "#22c55e";
                }
                renderDB();
            }

            // PUT
            else if (method === 'PUT') {
                const payload = parse(); if (!payload) return;
                if (isProdMode) {
                    if (!payload.id || !payload.timestamp) {
                        status.innerText = "400 BAD REQUEST"; status.style.color = "#ef4444";
                        document.getElementById('client-input').value = "// ERROR: Missing 'id' or 'timestamp'.\n// Schema validation prevented data corruption.";
                        return; 
                    }
                    db = payload; status.innerText = "200 OK"; status.style.color = "#22c55e";
                } else {
                    db = payload; status.innerText = "200 OK (CORRUPTED)"; status.style.color = "#ef4444";
                }
                renderDB();
            }

            // DELETE
            else if (method === 'DELETE') {
                if (!db) { status.innerText = "404 NOT FOUND"; return; }
                if (isProdMode) {
                    db._archived = true; db.status = "archived"; db.deleted_at = new Date().toISOString();
                    status.innerText = "204 NO CONTENT (ARCHIVED)"; status.style.color = "#22c55e";
                } else {
                    db = null; status.innerText = "204 NO CONTENT (DESTROYED)"; status.style.color = "#ef4444";
                }
                renderDB();
            }
        }

        function generateDB() {
            return { id: "REC-001", content: "Critical Data", timestamp: "2025-01-01T00:00:00Z", status: "active" };
        }

        function renderDB() {
            const el = document.getElementById('db-display');
            if (db) {
                el.innerText = JSON.stringify(db, null, 2);
                if (db._archived) el.className = "text-[10px] text-zinc-500 whitespace-pre-wrap line-through opacity-50";
                else if (db.id === undefined) el.className = "text-[10px] text-red-500 whitespace-pre-wrap font-bold"; 
                else el.className = "text-[10px] text-green-500 whitespace-pre-wrap";
            } else {
                el.innerText = "// [NULL] DATA DESTROYED"; el.className = "text-[10px] text-red-600 font-bold whitespace-pre-wrap";
            }
        }

        function parse() {
            try { return JSON.parse(document.getElementById('client-input').value); }
            catch(e) { document.getElementById('status-code').innerText = "INVALID JSON"; return null; }
        }
    </script>
</body>
</html>
</html>
